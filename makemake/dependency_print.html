<!DOCTYPE html>
<html>
<head>
	<title>makemake2</title>
	<style type="text/css">

body
{
	margin: 0;
}
canvas
{
	display: block;
}

	</style>
</head>
<body>
	<script type="text/javascript">

drawer = (function(modules){

var BORDER_MARGIN = 15;
var MODULE_WIDTH = 100;
var MODULE_HEIGHT = 30;
var MODULE_MARGIN_H = 35;
var MODULE_MARGIN_V = 60;
var MODULE_BORDER_COLOR = '#000000';
var MODULE_FILL_COLOR = '#FFFFFF';
var MODULE_TEXT_COLOR = '#000000';
var MAX_SCALE = 2;

var modules_by_name = {};
var modules_by_height = {};
var max_height = -1;

for (var i = 0; i < modules.length; i++)
{
	var m = modules[i];
	modules_by_name[m["name"]] = m;
	if (m["height"] > max_height)
		max_height = m["height"];
	if (!modules_by_height[m["height"]])
		modules_by_height[m["height"]] = [];
	modules_by_height[m["height"]].push(m);
}

var graph_width = 0;
var graph_height = (max_height + 2) * (MODULE_HEIGHT + MODULE_MARGIN_V) - MODULE_MARGIN_V; // lol

for (var i = 0; i <= max_height; i++)
	if (graph_width < modules_by_height[i].length)
		graph_width = modules_by_height[i].length;
graph_width = graph_width * (MODULE_WIDTH + MODULE_MARGIN_H) - MODULE_MARGIN_H;

var scale, offsetX, offsetY;

var canvas_node = document.createElement("canvas");
var canvas = canvas_node.getContext("2d");
document.body.appendChild(canvas_node);

function check_winsize()
{
	var w = window.innerWidth;
	var h = window.innerHeight;

	canvas_node.width = w;
	canvas_node.height = h;
	scale = Math.min(MAX_SCALE, w / (BORDER_MARGIN * 2 + graph_width), h / (BORDER_MARGIN * 2 + graph_height));
	offsetX = (w / scale - graph_width) / 2;
	offsetY = (h / scale - graph_height) / 2;
	canvas.scale(scale, scale);
	draw();
}

function draw_modules()
{
	var y = Math.ceil((graph_height - ((MODULE_HEIGHT + MODULE_MARGIN_V) * (max_height + 1) - MODULE_MARGIN_V)) / 2 + offsetY);
	var x, modules, height, i;

	canvas.textAlign = "center";
	for (height = max_height; height >= 0; height--)
	{
		modules = modules_by_height[height];
		x = Math.ceil((graph_width - (modules.length * (MODULE_WIDTH + MODULE_MARGIN_H) - MODULE_MARGIN_H)) / 2 + offsetX);
		for (i = 0; i < modules.length; i++)
		{
			canvas.strokeStyle = MODULE_BORDER_COLOR;
			canvas.strokeRect(x, y, MODULE_WIDTH, MODULE_HEIGHT);
			canvas.fillStyle = MODULE_FILL_COLOR;
			canvas.fillRect(x, y, MODULE_WIDTH, MODULE_HEIGHT);
			canvas.fillStyle = MODULE_TEXT_COLOR;
			canvas.fillText(modules[i]["name"], MODULE_WIDTH / 2 + x, MODULE_HEIGHT / 2 + y);
			x += MODULE_WIDTH + MODULE_MARGIN_H;
		}
		y += MODULE_HEIGHT + MODULE_MARGIN_V;
	}
}

function draw()
{
	canvas.clearRect(offsetX, offsetY, graph_width, graph_height);
	draw_modules();
}

window.addEventListener("resize", check_winsize);
check_winsize();

}([
]));

	</script>
</body>
</html>
